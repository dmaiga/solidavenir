{% extends 'base.html' %}
{% load static %}

{% block title %}Solid'Avenir - Plateforme de levée de fonds participative de confiance{% endblock %}

{% block extra_css %}
<style>
  .hero-section {
        background: linear-gradient(135deg, var(--primary-color) 0%, var(--dark-color) 100%);
        color: white;
        padding: 5rem 0;
        text-align: center;
        width: 100vw;
        position: relative;
        left: 50%;
        right: 50%;
        margin-left: -50vw;
        margin-right: -50vw;
    }
    
    .hero-content {
        position: relative;
        z-index: 2;
    }
  
    
    .feature-icon {
        font-size: 2.5rem;
        color: var(--primary-color);
        margin-bottom: 1rem;
    }
    
    .project-card {
        border: none;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        transition: transform 0.3s, box-shadow 0.3s;
        height: 100%;
    }
    
    .project-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    
    .progress {
        height: 10px;
        border-radius: 5px;
    }
    
    .category-badge {
        position: absolute;
        top: 15px;
        right: 15px;
        background: var(--secondary-color);
        color: var(--dark-color);
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
    }
    
    .stats-number {
        font-size: 2rem;
        font-weight: 700;
        color: var(--primary-color);
    }
    
</style>
{% endblock %}

{% block content %}


<!-- En-tête avec texte -->
<header class="hero-section">
    <div class="container">
        <div class="row align-items-center">
            <div class="col text-center hero-content">
                <h1 class="display-4 fw-bold mb-3">Finançons l'avenir de l'Afrique de l'Ouest</h1>
                <p class="lead mb-4">Solid'Avenir est une plateforme de levée de fonds participative qui connecte les porteurs de projets avec des contributeurs, en garantissant une totale transparence grâce à la technologie blockchain.</p>
                <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
                    <a href="{% url 'liste_projets' %}" class="btn btn-warning btn-lg px-4 gap-3">Découvrir les projets</a>
                    <a href="{% url 'creer_projet' %}" class="btn btn-outline-light btn-lg px-4">Proposer un projet</a>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Section statistiques -->
<section class="container ">
    <h2 class="section-title text-center">Notre impact</h2>
    
    <div class="row text-center">
        <div class="col-md-3 mb-4">
            <div class="stats-number" data-target="{{ projets_total }}">0</div>
            <p>Projets financés</p>
        </div>
        
        <div class="col-md-3 mb-4">
            <div class="stats-number" data-target="{{ donateurs_total }}">0</div>
            <p>Contributeurs actifs</p>
        </div>
        
        <div class="col-md-3 mb-4">
            <div class="stats-number" data-target="{{ dons_total }}">0</div>
            <p>FCFA collectés</p>
        </div>
        
        <div class="col-md-3 mb-4">
            <div class="stats-number" data-target="98">0</div>
            <p>Projets livrés</p>
        </div>
    </div>
</section>

<!-- Section projets populaires -->
<section class="container mb-5">
    <h2 class="section-title text-center mb-4">Projets populaires</h2>
    
    <div class="row">
        {% for projet in projets_populaires %}
        <div class="col-md-4 mb-4">
            <div class="card project-card">
                <span class="category-badge">Projet</span>
                {% if projet.document_justificatif %}
                <img src="{{ projet.document_justificatif.url }}" class="card-img-top" alt="{{ projet.titre }}" style="height: 200px; object-fit: cover;">
                {% else %}
                <img src="https://via.placeholder.com/300x200?text=Projet+Solid'Avenir" class="card-img-top" alt="{{ projet.titre }}" style="height: 200px; object-fit: cover;">
                {% endif %}
                <div class="card-body">
                    <h5 class="card-title">{{ projet.titre }}</h5>
                    <p class="card-text">{{ projet.description|truncatewords:20 }}</p>
               <div class="progress" style="height: 10px;">
    <div class="progress-bar bg-success progress-bar-custom" 
         role="progressbar" 
         style="width: {{ projet.pourcentage_financement|default:0 }}%;"
         aria-valuenow="{{ projet.pourcentage_financement|default:0 }}" 
         aria-valuemin="0" 
         aria-valuemax="100">
    </div>
</div>


                    <div class="d-flex justify-content-between text-muted small mb-3">
                        <span>{{ projet.pourcentage_financement }}% atteint</span>
                        <span>Projet actif</span>
                    </div>
                    <div class="d-flex justify-content-between align-items-center">
                        <strong>{{ projet.total_collecte|default:0|floatformat:0 }} FCFA / {{ projet.montant_demande|floatformat:0 }} FCFA</strong>
                        <a href="{% url 'detail_projet' projet.audit_uuid %}" class="btn btn-primary btn-sm">Contribuer</a>
                    </div>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12 text-center">
            <p>Aucun projet actif pour le moment.</p>
            <a href="{% url 'creer_projet' %}" class="btn btn-primary">Soyez le premier à proposer un projet</a>
        </div>
        {% endfor %}
    </div>
    
    {% if projets_populaires %}
    <div class="text-center mt-4">
        <a href="{% url 'liste_projets' %}" class="btn btn-outline-primary">Voir tous les projets</a>
    </div>
    {% endif %}
</section>

<!-- Section comment ça marche -->
<section class="bg-light py-5 mb-5">
    <div class="container">
        <h2 class="section-title text-center mb-5">Comment ça marche</h2>
        
        <div class="row">
            <div class="col-md-4 text-center mb-4">
                <div class="feature-icon">
                    <i class="bi bi-lightbulb"></i>
                </div>
                <h4>1. Soumettez votre projet</h4>
                <p>Décrivez votre initiative et ses objectifs. Notre équipe l'évaluera pour garantir sa faisabilité.</p>
            </div>
            
            <div class="col-md-4 text-center mb-4">
                <div class="feature-icon">
                    <i class="bi bi-people"></i>
                </div>
                <h4>2. Mobilisez la communauté</h4>
                <p>Partagez votre projet et mobilisez des contributeurs pour atteindre votre objectif financier.</p>
            </div>
            
            <div class="col-md-4 text-center mb-4">
                <div class="feature-icon">
                    <i class="bi bi-shield-check"></i>
                </div>
                <h4>3. Traçabilité blockchain</h4>
                <p>Chaque don et dépense est tracé sur Hedera Hashgraph pour une transparence totale.</p>
            </div>
        </div>
    </div>
</section>

{% endblock %}

{% block extra_js %}
<script>
    // Scripts spécifiques à la page d'accueil
    document.addEventListener('DOMContentLoaded', function() {
        // Animation des statistiques
        const counters = document.querySelectorAll('.stats-number');
        const speed = 200;
        
        counters.forEach(counter => {
            const target = counter.getAttribute('data-target');
            if (target) {
                const animate = () => {
                    const value = +counter.innerText;
                    const data = +target;
                    const time = value / speed;
                    
                    if(value < data) {
                        counter.innerText = Math.ceil(value + time);
                        setTimeout(animate, 1);
                    } else {
                        counter.innerText = data;
                    }
                }
                
                counter.innerText = '0';
                animate();
            }
        });
    });
</script>
{% endblock %}